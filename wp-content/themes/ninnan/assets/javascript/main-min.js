(function(window,document,undefined){var classes=[];var tests=[];var ModernizrProto={_version:"3.5.0",_config:{classPrefix:"",enableClasses:true,enableJSClass:true,usePrefixes:true},_q:[],on:function(test,cb){var self=this;setTimeout(function(){cb(self[test])},0)},addTest:function(name,fn,options){tests.push({name:name,fn:fn,options:options})},addAsyncTest:function(fn){tests.push({name:null,fn:fn})}};var Modernizr=function(){};Modernizr.prototype=ModernizrProto;Modernizr=new Modernizr;function is(obj,type){return typeof obj===type}function testRunner(){var featureNames;var feature;var aliasIdx;var result;var nameIdx;var featureName;var featureNameSplit;for(var featureIdx in tests){if(tests.hasOwnProperty(featureIdx)){featureNames=[];feature=tests[featureIdx];if(feature.name){featureNames.push(feature.name.toLowerCase());if(feature.options&&feature.options.aliases&&feature.options.aliases.length){for(aliasIdx=0;aliasIdx<feature.options.aliases.length;aliasIdx++){featureNames.push(feature.options.aliases[aliasIdx].toLowerCase())}}}result=is(feature.fn,"function")?feature.fn():feature.fn;for(nameIdx=0;nameIdx<featureNames.length;nameIdx++){featureName=featureNames[nameIdx];featureNameSplit=featureName.split(".");if(featureNameSplit.length===1){Modernizr[featureNameSplit[0]]=result}else{if(Modernizr[featureNameSplit[0]]&&!(Modernizr[featureNameSplit[0]]instanceof Boolean)){Modernizr[featureNameSplit[0]]=new Boolean(Modernizr[featureNameSplit[0]])}Modernizr[featureNameSplit[0]][featureNameSplit[1]]=result}classes.push((result?"":"no-")+featureNameSplit.join("-"))}}}}var docElement=document.documentElement;var isSVG=docElement.nodeName.toLowerCase()==="svg";function setClasses(classes){var className=docElement.className;var classPrefix=Modernizr._config.classPrefix||"";if(isSVG){className=className.baseVal}if(Modernizr._config.enableJSClass){var reJS=new RegExp("(^|\\s)"+classPrefix+"no-js(\\s|$)");className=className.replace(reJS,"$1"+classPrefix+"js$2")}if(Modernizr._config.enableClasses){className+=" "+classPrefix+classes.join(" "+classPrefix);if(isSVG){docElement.className.baseVal=className}else{docElement.className=className}}}var prefixes=ModernizrProto._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];ModernizrProto._prefixes=prefixes;function createElement(){if(typeof document.createElement!=="function"){return document.createElement(arguments[0])}else if(isSVG){return document.createElementNS.call(document,"http://www.w3.org/2000/svg",arguments[0])}else{return document.createElement.apply(document,arguments)}}function getBody(){var body=document.body;if(!body){body=createElement(isSVG?"svg":"body");body.fake=true}return body}function injectElementWithStyles(rule,callback,nodes,testnames){var mod="modernizr";var style;var ret;var node;var docOverflow;var div=createElement("div");var body=getBody();if(parseInt(nodes,10)){while(nodes--){node=createElement("div");node.id=testnames?testnames[nodes]:mod+(nodes+1);div.appendChild(node)}}style=createElement("style");style.type="text/css";style.id="s"+mod;(!body.fake?div:body).appendChild(style);body.appendChild(div);if(style.styleSheet){style.styleSheet.cssText=rule}else{style.appendChild(document.createTextNode(rule))}div.id=mod;if(body.fake){body.style.background="";body.style.overflow="hidden";docOverflow=docElement.style.overflow;docElement.style.overflow="hidden";docElement.appendChild(body)}ret=callback(div,rule);if(body.fake){body.parentNode.removeChild(body);docElement.style.overflow=docOverflow;docElement.offsetHeight}else{div.parentNode.removeChild(div)}return!!ret}var testStyles=ModernizrProto.testStyles=injectElementWithStyles;Modernizr.addTest("touchevents",function(){var bool;if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch){bool=true}else{var query=["@media (",prefixes.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");testStyles(query,function(node){bool=node.offsetTop===9})}return bool});testRunner();setClasses(classes);delete ModernizrProto.addTest;delete ModernizrProto.addAsyncTest;for(var i=0;i<Modernizr._q.length;i++){Modernizr._q[i]()}window.Modernizr=Modernizr})(window,document);"use strict";var MoveTo=function(){var defaults={tolerance:0,duration:800,easing:"easeOutQuart",callback:function callback(){}};function easeOutQuart(t,b,c,d){t/=d;t--;return-c*(t*t*t*t-1)+b}function getOffsetSum(elem){var top=0;var left=0;while(elem){top+=elem.offsetTop;left+=elem.offsetLeft;elem=elem.offsetParent}return{top:top,left:left}}function mergeObject(obj1,obj2){var obj3={};Object.keys(obj1).forEach(function(propertyName){obj3[propertyName]=obj1[propertyName]});Object.keys(obj2).forEach(function(propertyName){obj3[propertyName]=obj2[propertyName]});return obj3}function kebabCase(val){return val.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function MoveTo(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var easeFunctions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.options=mergeObject(defaults,options);this.easeFunctions=mergeObject({easeOutQuart:easeOutQuart},easeFunctions)}MoveTo.prototype.registerTrigger=function(dom,callback){var _this=this;if(!dom){return}var href=dom.getAttribute("href")||dom.getAttribute("data-target");var target=href&&href!=="#"?document.getElementById(href.substring(1)):0;var options=mergeObject(this.options,_getOptionsFromTriggerDom(dom,this.options));if(typeof callback==="function"){options.callback=callback}var listener=function listener(e){e.preventDefault();_this.move(target,options)};dom.addEventListener("click",listener,false);return function(){return dom.removeEventListener("click",listener,false)}};MoveTo.prototype.move=function(target){var _this2=this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(target!==0&&!target){return}options=mergeObject(this.options,options);var to=typeof target==="number"?target:getOffsetSum(target).top;var from=window.pageYOffset;to-=options.tolerance;var change=to-from;var startTime=null;var lastPageYOffset=void 0;var loop=function loop(currentTime){var currentPageYOffset=window.pageYOffset;if(!startTime){startTime=currentTime-1}var timeElapsed=currentTime-startTime;if(lastPageYOffset){if(change>0&&lastPageYOffset>currentPageYOffset||change<0&&lastPageYOffset<currentPageYOffset){return options.callback(target)}}lastPageYOffset=currentPageYOffset;var val=_this2.easeFunctions[options.easing](timeElapsed,from,change,options.duration);window.scroll(0,val);if(timeElapsed<options.duration){window.requestAnimationFrame(loop)}else{window.scroll(0,to);options.callback(target)}};window.requestAnimationFrame(loop)};MoveTo.prototype.addEaseFunction=function(name,fn){this.easeFunctions[name]=fn};function _getOptionsFromTriggerDom(dom,options){var domOptions={};Object.keys(options).forEach(function(key){var value=dom.getAttribute("data-mt-"+kebabCase(key));if(value){domOptions[key]=isNaN(value)?value:parseInt(value,10)}});return domOptions}return MoveTo}();if(typeof module!=="undefined"){module.exports=MoveTo}else{window.MoveTo=MoveTo}(function(root,blazy){if(typeof define==="function"&&define.amd){define(blazy)}else if(typeof exports==="object"){module.exports=blazy()}else{root.Blazy=blazy()}})(this,function(){"use strict";var _source,_viewport,_isRetina,_supportClosest,_attrSrc="src",_attrSrcset="srcset";return function Blazy(options){if(!document.querySelectorAll){var s=document.createStyleSheet();document.querySelectorAll=function(r,c,i,j,a){a=document.all,c=[],r=r.replace(/\[for\b/gi,"[htmlFor").split(",");for(i=r.length;i--;){s.addRule(r[i],"k:v");for(j=a.length;j--;)a[j].currentStyle.k&&c.push(a[j]);s.removeRule(0)}return c}}var scope=this;var util=scope._util={};util.elements=[];util.destroyed=true;scope.options=options||{};scope.options.error=scope.options.error||false;scope.options.offset=scope.options.offset||100;scope.options.root=scope.options.root||document;scope.options.success=scope.options.success||false;scope.options.selector=scope.options.selector||".b-lazy";scope.options.separator=scope.options.separator||"|";scope.options.containerClass=scope.options.container;scope.options.container=scope.options.containerClass?document.querySelectorAll(scope.options.containerClass):false;scope.options.errorClass=scope.options.errorClass||"b-error";scope.options.breakpoints=scope.options.breakpoints||false;scope.options.loadInvisible=scope.options.loadInvisible||false;scope.options.successClass=scope.options.successClass||"b-loaded";scope.options.validateDelay=scope.options.validateDelay||25;scope.options.saveViewportOffsetDelay=scope.options.saveViewportOffsetDelay||50;scope.options.srcset=scope.options.srcset||"data-srcset";scope.options.src=_source=scope.options.src||"data-src";_supportClosest=Element.prototype.closest;_isRetina=window.devicePixelRatio>1;_viewport={};_viewport.top=0-scope.options.offset;_viewport.left=0-scope.options.offset;scope.revalidate=function(){initialize(scope)};scope.load=function(elements,force){var opt=this.options;if(elements&&elements.length===undefined){loadElement(elements,force,opt)}else{each(elements,function(element){loadElement(element,force,opt)})}};scope.destroy=function(){var util=scope._util;if(scope.options.container){each(scope.options.container,function(object){unbindEvent(object,"scroll",util.validateT)})}unbindEvent(window,"scroll",util.validateT);unbindEvent(window,"resize",util.validateT);unbindEvent(window,"resize",util.saveViewportOffsetT);util.count=0;util.elements.length=0;util.destroyed=true};util.validateT=throttle(function(){validate(scope)},scope.options.validateDelay,scope);util.saveViewportOffsetT=throttle(function(){saveViewportOffset(scope.options.offset)},scope.options.saveViewportOffsetDelay,scope);saveViewportOffset(scope.options.offset);each(scope.options.breakpoints,function(object){if(object.width>=window.screen.width){_source=object.src;return false}});setTimeout(function(){initialize(scope)})};function initialize(self){var util=self._util;util.elements=toArray(self.options);util.count=util.elements.length;if(util.destroyed){util.destroyed=false;if(self.options.container){each(self.options.container,function(object){bindEvent(object,"scroll",util.validateT)})}bindEvent(window,"resize",util.saveViewportOffsetT);bindEvent(window,"resize",util.validateT);bindEvent(window,"scroll",util.validateT)}validate(self)}function validate(self){var util=self._util;for(var i=0;i<util.count;i++){var element=util.elements[i];if(elementInView(element,self.options)||hasClass(element,self.options.successClass)){self.load(element);util.elements.splice(i,1);util.count--;i--}}if(util.count===0){self.destroy()}}function elementInView(ele,options){var rect=ele.getBoundingClientRect();if(options.container&&_supportClosest){var elementContainer=ele.closest(options.containerClass);if(elementContainer){var containerRect=elementContainer.getBoundingClientRect();if(inView(containerRect,_viewport)){var top=containerRect.top-options.offset;var right=containerRect.right+options.offset;var bottom=containerRect.bottom+options.offset;var left=containerRect.left-options.offset;var containerRectWithOffset={top:top>_viewport.top?top:_viewport.top,right:right<_viewport.right?right:_viewport.right,bottom:bottom<_viewport.bottom?bottom:_viewport.bottom,left:left>_viewport.left?left:_viewport.left};return inView(rect,containerRectWithOffset)}else{return false}}}return inView(rect,_viewport)}function inView(rect,viewport){return rect.right>=viewport.left&&rect.bottom>=viewport.top&&rect.left<=viewport.right&&rect.top<=viewport.bottom}function loadElement(ele,force,options){if(!hasClass(ele,options.successClass)&&(force||options.loadInvisible||ele.offsetWidth>0&&ele.offsetHeight>0)){var dataSrc=getAttr(ele,_source)||getAttr(ele,options.src);if(dataSrc){var dataSrcSplitted=dataSrc.split(options.separator);var src=dataSrcSplitted[_isRetina&&dataSrcSplitted.length>1?1:0];var srcset=getAttr(ele,options.srcset);var isImage=equal(ele,"img");var parent=ele.parentNode;var isPicture=parent&&equal(parent,"picture");if(isImage||ele.src===undefined){var img=new Image;var onErrorHandler=function(){if(options.error)options.error(ele,"invalid");addClass(ele,options.errorClass);unbindEvent(img,"error",onErrorHandler);unbindEvent(img,"load",onLoadHandler)};var onLoadHandler=function(){if(isImage){if(!isPicture){handleSources(ele,src,srcset)}}else{ele.style.backgroundImage='url("'+src+'")'}itemLoaded(ele,options);unbindEvent(img,"load",onLoadHandler);unbindEvent(img,"error",onErrorHandler)};if(isPicture){img=ele;each(parent.getElementsByTagName("source"),function(source){handleSource(source,_attrSrcset,options.srcset)})}bindEvent(img,"error",onErrorHandler);bindEvent(img,"load",onLoadHandler);handleSources(img,src,srcset)}else{ele.src=src;itemLoaded(ele,options)}}else{if(equal(ele,"video")){each(ele.getElementsByTagName("source"),function(source){handleSource(source,_attrSrc,options.src)});ele.load();itemLoaded(ele,options)}else{if(options.error)options.error(ele,"missing");addClass(ele,options.errorClass)}}}}function itemLoaded(ele,options){addClass(ele,options.successClass);if(options.success)options.success(ele);removeAttr(ele,options.src);removeAttr(ele,options.srcset);each(options.breakpoints,function(object){removeAttr(ele,object.src)})}function handleSource(ele,attr,dataAttr){var dataSrc=getAttr(ele,dataAttr);if(dataSrc){setAttr(ele,attr,dataSrc);removeAttr(ele,dataAttr)}}function handleSources(ele,src,srcset){if(srcset){setAttr(ele,_attrSrcset,srcset)}ele.src=src}function setAttr(ele,attr,value){ele.setAttribute(attr,value)}function getAttr(ele,attr){return ele.getAttribute(attr)}function removeAttr(ele,attr){ele.removeAttribute(attr)}function equal(ele,str){return ele.nodeName.toLowerCase()===str}function hasClass(ele,className){return(" "+ele.className+" ").indexOf(" "+className+" ")!==-1}function addClass(ele,className){if(!hasClass(ele,className)){ele.className+=" "+className}}function toArray(options){var array=[];var nodelist=options.root.querySelectorAll(options.selector);for(var i=nodelist.length;i--;array.unshift(nodelist[i])){}return array}function saveViewportOffset(offset){_viewport.bottom=(window.innerHeight||document.documentElement.clientHeight)+offset;_viewport.right=(window.innerWidth||document.documentElement.clientWidth)+offset}function bindEvent(ele,type,fn){if(ele.attachEvent){ele.attachEvent&&ele.attachEvent("on"+type,fn)}else{ele.addEventListener(type,fn,{capture:false,passive:true})}}function unbindEvent(ele,type,fn){if(ele.detachEvent){ele.detachEvent&&ele.detachEvent("on"+type,fn)}else{ele.removeEventListener(type,fn,{capture:false,passive:true})}}function each(object,fn){if(object&&fn){var l=object.length;for(var i=0;i<l&&fn(object[i],i)!==false;i++){}}}function throttle(fn,minDelay,scope){var lastCall=0;return function(){var now=+new Date;if(now-lastCall<minDelay){return}lastCall=now;fn.apply(scope,arguments)}}});(function(){"use strict";var keyCounter=0;var allWaypoints={};function Waypoint(options){if(!options){throw new Error("No options passed to Waypoint constructor")}if(!options.element){throw new Error("No element option passed to Waypoint constructor")}if(!options.handler){throw new Error("No handler option passed to Waypoint constructor")}this.key="waypoint-"+keyCounter;this.options=Waypoint.Adapter.extend({},Waypoint.defaults,options);this.element=this.options.element;this.adapter=new Waypoint.Adapter(this.element);this.callback=options.handler;this.axis=this.options.horizontal?"horizontal":"vertical";this.enabled=this.options.enabled;this.triggerPoint=null;this.group=Waypoint.Group.findOrCreate({name:this.options.group,axis:this.axis});this.context=Waypoint.Context.findOrCreateByElement(this.options.context);if(Waypoint.offsetAliases[this.options.offset]){this.options.offset=Waypoint.offsetAliases[this.options.offset]}this.group.add(this);this.context.add(this);allWaypoints[this.key]=this;keyCounter+=1}Waypoint.prototype.queueTrigger=function(direction){this.group.queueTrigger(this,direction)};Waypoint.prototype.trigger=function(args){if(!this.enabled){return}if(this.callback){this.callback.apply(this,args)}};Waypoint.prototype.destroy=function(){this.context.remove(this);this.group.remove(this);delete allWaypoints[this.key]};Waypoint.prototype.disable=function(){this.enabled=false;return this};Waypoint.prototype.enable=function(){this.context.refresh();this.enabled=true;return this};Waypoint.prototype.next=function(){return this.group.next(this)};Waypoint.prototype.previous=function(){return this.group.previous(this)};Waypoint.invokeAll=function(method){var allWaypointsArray=[];for(var waypointKey in allWaypoints){allWaypointsArray.push(allWaypoints[waypointKey])}for(var i=0,end=allWaypointsArray.length;i<end;i++){allWaypointsArray[i][method]()}};Waypoint.destroyAll=function(){Waypoint.invokeAll("destroy")};Waypoint.disableAll=function(){Waypoint.invokeAll("disable")};Waypoint.enableAll=function(){Waypoint.Context.refreshAll();for(var waypointKey in allWaypoints){allWaypoints[waypointKey].enabled=true}return this};Waypoint.refreshAll=function(){Waypoint.Context.refreshAll()};Waypoint.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight};Waypoint.viewportWidth=function(){return document.documentElement.clientWidth};Waypoint.adapters=[];Waypoint.defaults={context:window,continuous:true,enabled:true,group:"default",horizontal:false,offset:0};Waypoint.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}};window.Waypoint=Waypoint})();(function(){"use strict";function requestAnimationFrameShim(callback){window.setTimeout(callback,1e3/60)}var keyCounter=0;var contexts={};var Waypoint=window.Waypoint;var oldWindowLoad=window.onload;function Context(element){this.element=element;this.Adapter=Waypoint.Adapter;this.adapter=new this.Adapter(element);this.key="waypoint-context-"+keyCounter;this.didScroll=false;this.didResize=false;this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()};this.waypoints={vertical:{},horizontal:{}};element.waypointContextKey=this.key;contexts[element.waypointContextKey]=this;keyCounter+=1;if(!Waypoint.windowContext){Waypoint.windowContext=true;Waypoint.windowContext=new Context(window)}this.createThrottledScrollHandler();this.createThrottledResizeHandler()}Context.prototype.add=function(waypoint){var axis=waypoint.options.horizontal?"horizontal":"vertical";this.waypoints[axis][waypoint.key]=waypoint;this.refresh()};Context.prototype.checkEmpty=function(){var horizontalEmpty=this.Adapter.isEmptyObject(this.waypoints.horizontal);var verticalEmpty=this.Adapter.isEmptyObject(this.waypoints.vertical);var isWindow=this.element==this.element.window;if(horizontalEmpty&&verticalEmpty&&!isWindow){this.adapter.off(".waypoints");delete contexts[this.key]}};Context.prototype.createThrottledResizeHandler=function(){var self=this;function resizeHandler(){self.handleResize();self.didResize=false}this.adapter.on("resize.waypoints",function(){if(!self.didResize){self.didResize=true;Waypoint.requestAnimationFrame(resizeHandler)}})};Context.prototype.createThrottledScrollHandler=function(){var self=this;function scrollHandler(){self.handleScroll();self.didScroll=false}this.adapter.on("scroll.waypoints",function(){if(!self.didScroll||Waypoint.isTouch){self.didScroll=true;Waypoint.requestAnimationFrame(scrollHandler)}})};Context.prototype.handleResize=function(){Waypoint.Context.refreshAll()};Context.prototype.handleScroll=function(){var triggeredGroups={};var axes={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var axisKey in axes){var axis=axes[axisKey];var isForward=axis.newScroll>axis.oldScroll;var direction=isForward?axis.forward:axis.backward;for(var waypointKey in this.waypoints[axisKey]){var waypoint=this.waypoints[axisKey][waypointKey];if(waypoint.triggerPoint===null){continue}var wasBeforeTriggerPoint=axis.oldScroll<waypoint.triggerPoint;var nowAfterTriggerPoint=axis.newScroll>=waypoint.triggerPoint;var crossedForward=wasBeforeTriggerPoint&&nowAfterTriggerPoint;var crossedBackward=!wasBeforeTriggerPoint&&!nowAfterTriggerPoint;if(crossedForward||crossedBackward){waypoint.queueTrigger(direction);triggeredGroups[waypoint.group.id]=waypoint.group}}}for(var groupKey in triggeredGroups){triggeredGroups[groupKey].flushTriggers()}this.oldScroll={x:axes.horizontal.newScroll,y:axes.vertical.newScroll}};Context.prototype.innerHeight=function(){if(this.element==this.element.window){return Waypoint.viewportHeight()}return this.adapter.innerHeight()};Context.prototype.remove=function(waypoint){delete this.waypoints[waypoint.axis][waypoint.key];this.checkEmpty()};Context.prototype.innerWidth=function(){if(this.element==this.element.window){return Waypoint.viewportWidth()}return this.adapter.innerWidth()};Context.prototype.destroy=function(){var allWaypoints=[];for(var axis in this.waypoints){for(var waypointKey in this.waypoints[axis]){allWaypoints.push(this.waypoints[axis][waypointKey])}}for(var i=0,end=allWaypoints.length;i<end;i++){allWaypoints[i].destroy()}};Context.prototype.refresh=function(){var isWindow=this.element==this.element.window;var contextOffset=isWindow?undefined:this.adapter.offset();var triggeredGroups={};var axes;this.handleScroll();axes={horizontal:{contextOffset:isWindow?0:contextOffset.left,contextScroll:isWindow?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:isWindow?0:contextOffset.top,contextScroll:isWindow?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var axisKey in axes){var axis=axes[axisKey];for(var waypointKey in this.waypoints[axisKey]){var waypoint=this.waypoints[axisKey][waypointKey];var adjustment=waypoint.options.offset;var oldTriggerPoint=waypoint.triggerPoint;var elementOffset=0;var freshWaypoint=oldTriggerPoint==null;var contextModifier,wasBeforeScroll,nowAfterScroll;var triggeredBackward,triggeredForward;if(waypoint.element!==waypoint.element.window){elementOffset=waypoint.adapter.offset()[axis.offsetProp]}if(typeof adjustment==="function"){adjustment=adjustment.apply(waypoint)}else if(typeof adjustment==="string"){adjustment=parseFloat(adjustment);if(waypoint.options.offset.indexOf("%")>-1){adjustment=Math.ceil(axis.contextDimension*adjustment/100)}}contextModifier=axis.contextScroll-axis.contextOffset;waypoint.triggerPoint=Math.floor(elementOffset+contextModifier-adjustment);wasBeforeScroll=oldTriggerPoint<axis.oldScroll;nowAfterScroll=waypoint.triggerPoint>=axis.oldScroll;triggeredBackward=wasBeforeScroll&&nowAfterScroll;triggeredForward=!wasBeforeScroll&&!nowAfterScroll;if(!freshWaypoint&&triggeredBackward){waypoint.queueTrigger(axis.backward);triggeredGroups[waypoint.group.id]=waypoint.group}else if(!freshWaypoint&&triggeredForward){waypoint.queueTrigger(axis.forward);triggeredGroups[waypoint.group.id]=waypoint.group}else if(freshWaypoint&&axis.oldScroll>=waypoint.triggerPoint){waypoint.queueTrigger(axis.forward);triggeredGroups[waypoint.group.id]=waypoint.group}}}Waypoint.requestAnimationFrame(function(){for(var groupKey in triggeredGroups){triggeredGroups[groupKey].flushTriggers()}});return this};Context.findOrCreateByElement=function(element){return Context.findByElement(element)||new Context(element)};Context.refreshAll=function(){for(var contextId in contexts){contexts[contextId].refresh()}};Context.findByElement=function(element){return contexts[element.waypointContextKey]};window.onload=function(){if(oldWindowLoad){oldWindowLoad()}Context.refreshAll()};Waypoint.requestAnimationFrame=function(callback){var requestFn=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||requestAnimationFrameShim;requestFn.call(window,callback)};Waypoint.Context=Context})();(function(){"use strict";function byTriggerPoint(a,b){return a.triggerPoint-b.triggerPoint}function byReverseTriggerPoint(a,b){return b.triggerPoint-a.triggerPoint}var groups={vertical:{},horizontal:{}};var Waypoint=window.Waypoint;function Group(options){this.name=options.name;this.axis=options.axis;this.id=this.name+"-"+this.axis;this.waypoints=[];this.clearTriggerQueues();groups[this.axis][this.name]=this}Group.prototype.add=function(waypoint){this.waypoints.push(waypoint)};Group.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}};Group.prototype.flushTriggers=function(){for(var direction in this.triggerQueues){var waypoints=this.triggerQueues[direction];var reverse=direction==="up"||direction==="left";waypoints.sort(reverse?byReverseTriggerPoint:byTriggerPoint);for(var i=0,end=waypoints.length;i<end;i+=1){var waypoint=waypoints[i];if(waypoint.options.continuous||i===waypoints.length-1){waypoint.trigger([direction])}}}this.clearTriggerQueues()};Group.prototype.next=function(waypoint){this.waypoints.sort(byTriggerPoint);var index=Waypoint.Adapter.inArray(waypoint,this.waypoints);var isLast=index===this.waypoints.length-1;return isLast?null:this.waypoints[index+1]};Group.prototype.previous=function(waypoint){this.waypoints.sort(byTriggerPoint);var index=Waypoint.Adapter.inArray(waypoint,this.waypoints);return index?this.waypoints[index-1]:null};Group.prototype.queueTrigger=function(waypoint,direction){this.triggerQueues[direction].push(waypoint)};Group.prototype.remove=function(waypoint){var index=Waypoint.Adapter.inArray(waypoint,this.waypoints);if(index>-1){this.waypoints.splice(index,1)}};Group.prototype.first=function(){return this.waypoints[0]};Group.prototype.last=function(){return this.waypoints[this.waypoints.length-1]};Group.findOrCreate=function(options){return groups[options.axis][options.name]||new Group(options)};Waypoint.Group=Group})();(function(){"use strict";var Waypoint=window.Waypoint;function isWindow(element){return element===element.window}function getWindow(element){if(isWindow(element)){return element}return element.defaultView}function NoFrameworkAdapter(element){this.element=element;this.handlers={}}NoFrameworkAdapter.prototype.innerHeight=function(){var isWin=isWindow(this.element);return isWin?this.element.innerHeight:this.element.clientHeight};NoFrameworkAdapter.prototype.innerWidth=function(){var isWin=isWindow(this.element);return isWin?this.element.innerWidth:this.element.clientWidth};NoFrameworkAdapter.prototype.off=function(event,handler){function removeListeners(element,listeners,handler){for(var i=0,end=listeners.length-1;i<end;i++){var listener=listeners[i];if(!handler||handler===listener){element.removeEventListener(listener)}}}var eventParts=event.split(".");var eventType=eventParts[0];var namespace=eventParts[1];var element=this.element;if(namespace&&this.handlers[namespace]&&eventType){removeListeners(element,this.handlers[namespace][eventType],handler);this.handlers[namespace][eventType]=[]}else if(eventType){for(var ns in this.handlers){removeListeners(element,this.handlers[ns][eventType]||[],handler);this.handlers[ns][eventType]=[]}}else if(namespace&&this.handlers[namespace]){for(var type in this.handlers[namespace]){removeListeners(element,this.handlers[namespace][type],handler)}this.handlers[namespace]={}}};NoFrameworkAdapter.prototype.offset=function(){if(!this.element.ownerDocument){return null}var documentElement=this.element.ownerDocument.documentElement;var win=getWindow(this.element.ownerDocument);var rect={top:0,left:0};if(this.element.getBoundingClientRect){rect=this.element.getBoundingClientRect()}return{top:rect.top+win.pageYOffset-documentElement.clientTop,left:rect.left+win.pageXOffset-documentElement.clientLeft}};NoFrameworkAdapter.prototype.on=function(event,handler){var eventParts=event.split(".");var eventType=eventParts[0];var namespace=eventParts[1]||"__default";var nsHandlers=this.handlers[namespace]=this.handlers[namespace]||{};var nsTypeList=nsHandlers[eventType]=nsHandlers[eventType]||[];nsTypeList.push(handler);this.element.addEventListener(eventType,handler)};NoFrameworkAdapter.prototype.outerHeight=function(includeMargin){var height=this.innerHeight();var computedStyle;if(includeMargin&&!isWindow(this.element)){computedStyle=window.getComputedStyle(this.element);height+=parseInt(computedStyle.marginTop,10);height+=parseInt(computedStyle.marginBottom,10)}return height};NoFrameworkAdapter.prototype.outerWidth=function(includeMargin){var width=this.innerWidth();var computedStyle;if(includeMargin&&!isWindow(this.element)){computedStyle=window.getComputedStyle(this.element);width+=parseInt(computedStyle.marginLeft,10);width+=parseInt(computedStyle.marginRight,10)}return width};NoFrameworkAdapter.prototype.scrollLeft=function(){var win=getWindow(this.element);return win?win.pageXOffset:this.element.scrollLeft};NoFrameworkAdapter.prototype.scrollTop=function(){var win=getWindow(this.element);return win?win.pageYOffset:this.element.scrollTop};NoFrameworkAdapter.extend=function(){var args=Array.prototype.slice.call(arguments);function merge(target,obj){if(typeof target==="object"&&typeof obj==="object"){for(var key in obj){if(obj.hasOwnProperty(key)){target[key]=obj[key]}}}return target}for(var i=1,end=args.length;i<end;i++){merge(args[0],args[i])}return args[0]};NoFrameworkAdapter.inArray=function(element,array,i){return array==null?-1:array.indexOf(element,i)};NoFrameworkAdapter.isEmptyObject=function(obj){for(var name in obj){return false}return true};Waypoint.adapters.push({name:"noframework",Adapter:NoFrameworkAdapter});Waypoint.Adapter=NoFrameworkAdapter})();(function(window){"use strict";var doc=document,win=window;function init($){var defaultSettings={pageClass:"dragend-page",direction:"horizontal",minDragDistance:"40",onSwipeStart:noop,onSwipeEnd:noop,onDragStart:noop,onDrag:noop,onDragEnd:noop,afterInitialize:noop,keyboardNavigation:false,stopPropagation:false,itemsInPage:1,scribe:0,borderBetweenPages:0,duration:300,preventDrag:false},isTouch="ontouchstart"in win,startEvent=isTouch?"touchstart":"mousedown",moveEvent=isTouch?"touchmove":"mousemove",endEvent=isTouch?"touchend":"mouseup",keycodes={37:"left",38:"up",39:"right",40:"down"},errors={pages:"No pages found"},containerStyles={overflow:"hidden",padding:0},supports=function(){var div=doc.createElement("div"),vendors="Khtml Ms O Moz Webkit".split(" "),len=vendors.length;return function(prop){if(prop in div.style)return true;prop=prop.replace(/^[a-z]/,function(val){return val.toUpperCase()});while(len--){if(vendors[len]+prop in div.style){return true}}return false}}(),supportTransform=supports("transform");function noop(){}function falseFn(){return false}function setStyles(element,styles){var property,value;for(property in styles){if(styles.hasOwnProperty(property)){value=styles[property];switch(property){case"height":case"width":case"marginLeft":case"marginTop":value+="px"}element.style[property]=value}}return element}function extend(destination,source){var property;for(property in source){destination[property]=source[property]}return destination}function proxy(fn,context){return function(){return fn.apply(context,Array.prototype.slice.call(arguments))}}function getElementsByClassName(className,root){var elements;if($){elements=$(root).find("."+className)}else{elements=Array.prototype.slice.call(root.getElementsByClassName(className))}return elements}function animate(element,propery,to,speed,callback){var propertyObj={};propertyObj[propery]=to;if($){$(element).animate(propertyObj,speed,callback)}else{setStyles(element,propertyObj)}}function getCoords(event){var touches=event.touches,data=touches&&touches.length?touches:event.changedTouches;return{x:isTouch?data[0].pageX:event.pageX,y:isTouch?data[0].pageY:event.pageY}}function Dragend(container,settings){var defaultSettingsCopy=extend({},defaultSettings);this.settings=extend(defaultSettingsCopy,settings);this.container=container;this.pageContainer=doc.createElement("div");this.scrollBorder={x:0,y:0};this.page=0;this.preventScroll=false;this.pageCssProperties={margin:0};this._onStart=proxy(this._onStart,this);this._onMove=proxy(this._onMove,this);this._onEnd=proxy(this._onEnd,this);this._onKeydown=proxy(this._onKeydown,this);this._sizePages=proxy(this._sizePages,this);this._afterScrollTransform=proxy(this._afterScrollTransform,this);this.pageContainer.innerHTML=container.cloneNode(true).innerHTML;container.innerHTML="";container.appendChild(this.pageContainer);this._scroll=supportTransform?this._scrollWithTransform:this._scrollWithoutTransform;this._animateScroll=supportTransform?this._animateScrollWithTransform:this._animateScrollWithoutTransform;setStyles(container,containerStyles);setTimeout(proxy(function(){this.updateInstance(settings);if(!this.settings.preventDrag){this._observe()}this.settings.afterInitialize.call(this)},this),10)}function addEventListener(container,event,callback){if($){$(container).on(event,callback)}else{container.addEventListener(event,callback,false)}}function removeEventListener(container,event,callback){if($){$(container).off(event,callback)}else{container.removeEventListener(event,callback,false)}}extend(Dragend.prototype,{_checkOverscroll:function(direction,x,y){var coordinates={x:x,y:y,overscroll:true};switch(direction){case"right":if(!this.scrollBorder.x){coordinates.x=Math.round((x-this.scrollBorder.x)/5);return coordinates}break;case"left":if((this.pagesCount-1)*this.pageDimentions.width<=this.scrollBorder.x){coordinates.x=Math.round(-((Math.ceil(this.pagesCount)-1)*(this.pageDimentions.width+this.settings.borderBetweenPages))+x/5);return coordinates}break;case"down":if(!this.scrollBorder.y){coordinates.y=Math.round((y-this.scrollBorder.y)/5);return coordinates}break;case"up":if((this.pagesCount-1)*this.pageDimentions.height<=this.scrollBorder.y){coordinates.y=Math.round(-((Math.ceil(this.pagesCount)-1)*(this.pageDimentions.height+this.settings.borderBetweenPages))+y/5);return coordinates}break}return{x:x-this.scrollBorder.x,y:y-this.scrollBorder.y,overscroll:false}},_observe:function(){addEventListener(this.container,startEvent,this._onStart);this.container.onselectstart=falseFn;this.container.ondragstart=falseFn;if(this.settings.keyboardNavigation){addEventListener(doc.body,"keydown",this._onKeydown)}addEventListener(win,"resize",this._sizePages)},_onStart:function(event){event=event.originalEvent||event;if(this.settings.stopPropagation){event.stopPropagation()}addEventListener(doc.body,moveEvent,this._onMove);addEventListener(doc.body,endEvent,this._onEnd);this.startCoords=getCoords(event);this.settings.onDragStart.call(this,event)},_onMove:function(event){event=event.originalEvent||event;if(event.touches&&event.touches.length>1||event.scale&&event.scale!==1)return;event.preventDefault();if(this.settings.stopPropagation){event.stopPropagation()}var parsedEvent=this._parseEvent(event),coordinates=this._checkOverscroll(parsedEvent.direction,-parsedEvent.distanceX,-parsedEvent.distanceY);this.settings.onDrag.call(this,this.activeElement,parsedEvent,coordinates.overscroll,event);if(!this.preventScroll){this._scroll(coordinates)}},_onEnd:function(event){event=event.originalEvent||event;if(this.settings.stopPropagation){event.stopPropagation()}var parsedEvent=this._parseEvent(event);this.startCoords={x:0,y:0};if(Math.abs(parsedEvent.distanceX)>this.settings.minDragDistance||Math.abs(parsedEvent.distanceY)>this.settings.minDragDistance){this.swipe(parsedEvent.direction)}else if(parsedEvent.distanceX>0||parsedEvent.distanceX>0){this._scrollToPage()}this.settings.onDragEnd.call(this,this.container,this.activeElement,this.page,event);removeEventListener(doc.body,moveEvent,this._onMove);removeEventListener(doc.body,endEvent,this._onEnd)},_parseEvent:function(event){var coords=getCoords(event),x=this.startCoords.x-coords.x,y=this.startCoords.y-coords.y;return this._addDistanceValues(x,y)},_addDistanceValues:function(x,y){var eventData={distanceX:0,distanceY:0};if(this.settings.direction==="horizontal"){eventData.distanceX=x;eventData.direction=x>0?"left":"right"}else{eventData.distanceY=y;eventData.direction=y>0?"up":"down"}return eventData},_onKeydown:function(event){var direction=keycodes[event.keyCode];if(direction){this._scrollToPage(direction)}},_setHorizontalContainerCssValues:function(){extend(this.pageCssProperties,{cssFloat:"left",overflowY:"auto",overflowX:"hidden",padding:0,display:"block"});setStyles(this.pageContainer,{overflow:"hidden",width:(this.pageDimentions.width+this.settings.borderBetweenPages)*this.pagesCount,boxSizing:"content-box","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3,margin:0,padding:0})},_setVerticalContainerCssValues:function(){extend(this.pageCssProperties,{overflow:"hidden",padding:0,display:"block"});setStyles(this.pageContainer,{"padding-bottom":this.settings.scribe,boxSizing:"content-box","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3,margin:0})},setContainerCssValues:function(){if(this.settings.direction==="horizontal"){this._setHorizontalContainerCssValues()}else{this._setVerticalContainerCssValues()}},_setPageDimentions:function(){var width=this.container.offsetWidth,height=this.container.offsetHeight;if(this.settings.direction==="horizontal"){width=width-parseInt(this.settings.scribe,10)}else{height=height-parseInt(this.settings.scribe,10)}this.pageDimentions={width:width,height:height}},_sizePages:function(){var pagesCount=this.pages.length;this._setPageDimentions();this.setContainerCssValues();if(this.settings.direction==="horizontal"){extend(this.pageCssProperties,{height:this.pageDimentions.height,width:this.pageDimentions.width/this.settings.itemsInPage})}else{extend(this.pageCssProperties,{height:this.pageDimentions.height/this.settings.itemsInPage,width:this.pageDimentions.width})}for(var i=0;i<pagesCount;i++){setStyles(this.pages[i],this.pageCssProperties)}this._jumpToPage("page",this.page)},_calcNewPage:function(direction,pageNumber){var borderBetweenPages=this.settings.borderBetweenPages,height=this.pageDimentions.height,width=this.pageDimentions.width,page=this.page;switch(direction){case"up":if(page<this.pagesCount-1){this.scrollBorder.y=this.scrollBorder.y+height+borderBetweenPages;this.page++}break;case"down":if(page>0){this.scrollBorder.y=this.scrollBorder.y-height-borderBetweenPages;this.page--}break;case"left":if(page<this.pagesCount-1){this.scrollBorder.x=this.scrollBorder.x+width+borderBetweenPages;this.page++}break;case"right":if(page>0){this.scrollBorder.x=this.scrollBorder.x-width-borderBetweenPages;this.page--}break;case"page":switch(this.settings.direction){case"horizontal":this.scrollBorder.x=(width+borderBetweenPages)*pageNumber;break;case"vertical":this.scrollBorder.y=(height+borderBetweenPages)*pageNumber;break}this.page=pageNumber;break;default:this.scrollBorder.y=0;this.scrollBorder.x=0;this.page=0;break}},_onSwipeEnd:function(){this.preventScroll=false;this.activeElement=this.pages[this.page*this.settings.itemsInPage];this.settings.onSwipeEnd.call(this,this.container,this.activeElement,this.page)},_jumpToPage:function(options,pageNumber){if(options){this._calcNewPage(options,pageNumber)}this._scroll({x:-this.scrollBorder.x,y:-this.scrollBorder.y})},_scrollToPage:function(options,pageNumber){this.preventScroll=true;if(options)this._calcNewPage(options,pageNumber);this._animateScroll()},_scrollWithTransform:function(coordinates){var style=this.settings.direction==="horizontal"?"translateX("+coordinates.x+"px)":"translateY("+coordinates.y+"px)";setStyles(this.pageContainer,{"-webkit-transform":style,"-moz-transform":style,"-ms-transform":style,"-o-transform":style,transform:style})},_animateScrollWithTransform:function(){var style="transform "+this.settings.duration+"ms ease-out",container=this.container,afterScrollTransform=this._afterScrollTransform;setStyles(this.pageContainer,{"-webkit-transition":"-webkit-"+style,"-moz-transition":"-moz-"+style,"-ms-transition":"-ms-"+style,"-o-transition":"-o-"+style,transition:style});this._scroll({x:-this.scrollBorder.x,y:-this.scrollBorder.y});addEventListener(this.container,"webkitTransitionEnd",afterScrollTransform);addEventListener(this.container,"oTransitionEnd",afterScrollTransform);addEventListener(this.container,"transitionend",afterScrollTransform);addEventListener(this.container,"transitionEnd",afterScrollTransform)},_afterScrollTransform:function(){var container=this.container,afterScrollTransform=this._afterScrollTransform;this._onSwipeEnd();removeEventListener(container,"webkitTransitionEnd",afterScrollTransform);removeEventListener(container,"oTransitionEnd",afterScrollTransform);removeEventListener(container,"transitionend",afterScrollTransform);removeEventListener(container,"transitionEnd",afterScrollTransform);setStyles(this.pageContainer,{"-webkit-transition":"","-moz-transition":"","-ms-transition":"","-o-transition":"",transition:""})},_scrollWithoutTransform:function(coordinates){var styles=this.settings.direction==="horizontal"?{marginLeft:coordinates.x}:{marginTop:coordinates.y};setStyles(this.pageContainer,styles)},_animateScrollWithoutTransform:function(){var property=this.settings.direction==="horizontal"?"marginLeft":"marginTop",value=this.settings.direction==="horizontal"?-this.scrollBorder.x:-this.scrollBorder.y;animate(this.pageContainer,property,value,this.settings.duration,proxy(this._onSwipeEnd,this))},swipe:function(direction){this.settings.onSwipeStart.call(this,this.container,this.activeElement,this.page);this._scrollToPage(direction)},updateInstance:function(settings){settings=settings||{};if(typeof settings==="object")extend(this.settings,settings);this.pages=getElementsByClassName(this.settings.pageClass,this.pageContainer);if(this.pages.length){this.pagesCount=this.pages.length/this.settings.itemsInPage}else{throw new Error(errors.pages)}this.activeElement=this.pages[this.page*this.settings.itemsInPage];this._sizePages();if(this.settings.jumpToPage){this.jumpToPage(settings.jumpToPage);delete this.settings.jumpToPage}if(this.settings.scrollToPage){this.scrollToPage(this.settings.scrollToPage);delete this.settings.scrollToPage}if(this.settings.destroy){this.destroy();delete this.settings.destroy}},destroy:function(){var container=this.container;removeEventListener(container,startEvent);removeEventListener(container,moveEvent);removeEventListener(container,endEvent);removeEventListener(doc.body,"keydown",this._onKeydown);removeEventListener(win,"resize",this._sizePages);container.removeAttribute("style");for(var i=0;i<this.pages.length;i++){this.pages[i].removeAttribute("style")}container.innerHTML=this.pageContainer.innerHTML},scrollToPage:function(page){this._scrollToPage("page",page-1)},jumpToPage:function(page){this._jumpToPage("page",page-1)}});if($){$.fn.dragend=function(settings){settings=settings||{};this.each(function(){var instance=$(this).data("dragend");if(instance){instance.updateInstance(settings)}else{instance=new Dragend(this,settings);$(this).data("dragend",instance)}if(typeof settings==="string")instance.swipe(settings)});return this}}return Dragend}if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(function(){return init(win.jQuery||win.Zepto)})}else{win.Dragend=init(win.jQuery||win.Zepto)}})(window);(function(window){"use strict";var doc=window.document;var activeClass="is-active";var loadedClass="is-loaded";var errorClass="is-error";var Ninnan={init:function(){Ninnan.navigation();Ninnan.lazyImages();Ninnan.scrollButtons();Ninnan.chapters();Ninnan.linkJump()},linkJump:function(){var hashLinks=doc.querySelectorAll('a[href^="#"]:not(.js-scrollButton)');Array.from(hashLinks,function(linkEl){linkEl.addEventListener("click",function(e){if(e.metaKey||e.ctrlKey){return}var href=linkEl.getAttribute("href");var targetEl=doc.querySelector(href.substring(href.indexOf("#")));if(targetEl){targetEl.scrollIntoView();window.setTimeout(function(){targetEl.scrollIntoView()},200);e.preventDefault()}})})},navigation:function(){var navEl=doc.querySelector(".js-nav");function toggleNav(){navEl.classList.toggle(activeClass);navEl.setAttribute("aria-expanded",!navEl.classList.contains(activeClass))}if(navEl){var navLinks=navEl.querySelectorAll("a");var toggleButtons=doc.querySelectorAll(".js-navToggle");Array.from(toggleButtons,function(buttonEl){buttonEl.addEventListener("click",function(e){toggleNav();e.preventDefault()})});Array.from(navLinks,function(navLink){navLink.addEventListener("click",function(e){if(e.metaKey||e.ctrlKey){return}toggleNav()})})}},lazyImages:function(){var slideshows={};var lazySelector=".js-lazy";var paginationSelector=".js-slideshowPagination";var captionSelector=".js-slideshowCaption";var itemSelector=".js-slideshowItem";var sliderSelector=".js-slideshowSlider";var captionText="";var reversedClass="is-reversed";var viewportHeight=Math.max(doc.documentElement.clientHeight,window.innerHeight||0);var lazyImages=new Blazy({offset:viewportHeight,selector:lazySelector,successClass:loadedClass,errorClass:errorClass,success:function(loadedImage){var slideshowId=loadedImage.getAttribute("data-slideshow");if(slideshowId){var slideshowEl=doc.getElementById(slideshowId);if(!slideshowEl){return}var slides=parseInt(slideshowEl.getAttribute("data-slides"));if(!slideshows[slideshowId]){slideshows[slideshowId]={el:slideshowEl,sliderEl:slideshowEl.querySelector(sliderSelector),slides:slides,loaded:0,dragend:null};if(slides>1){window.setTimeout(function(){var notLoaded=Array.from(slideshowEl.querySelectorAll(lazySelector+":not(."+loadedClass+")"));notLoaded=notLoaded.filter(function(notLoadedImage){if(notLoadedImage.getAttribute("data-src")!==loadedImage.getAttribute("src")&&notLoadedImage.classList.contains(loadedClass)===false){return notLoadedImage}});lazyImages.load(notLoaded,true)},500)}}slideshows[slideshowId].loaded+=1;if(slideshows[slideshowId].slides>1&&slideshows[slideshowId].slides===slideshows[slideshowId].loaded){var slideshowNavButtons=slideshowEl.querySelectorAll(".js-slideshowNavItem");var slideshowLeftButton=slideshowEl.querySelector(".js-slideshowLeft");var slideshowRightButton=slideshowEl.querySelector(".js-slideshowRight");slideshows[slideshowId].dragend=new Dragend(slideshows[slideshowId].sliderEl,{pageClass:"js-slideshowItem",afterInitialize:function(){slideshowEl.classList.add(activeClass);var slideshow=this;if(slideshowNavButtons){if(slideshowNavButtons[slideshow.page]){slideshowNavButtons[slideshow.page].classList.add(activeClass)}Array.from(slideshowNavButtons,function(buttonEl){buttonEl.addEventListener("click",function(e){slideshow.scrollToPage(parseInt(buttonEl.getAttribute("data-index")));buttonEl.classList.add(activeClass);e.preventDefault()})})}if(!Modernizr.touchevents&&slideshowLeftButton&&slideshowRightButton){slideshowLeftButton.addEventListener("click",function(e){if(slideshow.page!==0){slideshow.scrollToPage(slideshow.page)}else{slideshow.scrollToPage(slideshow.page+2)}e.preventDefault()});slideshowRightButton.addEventListener("click",function(e){if(slideshow.page+1!==slideshow.pagesCount){slideshow.scrollToPage(slideshow.page+2)}else{slideshow.scrollToPage(slideshow.page)}e.preventDefault()})}Waypoint.refreshAll()},onSwipeEnd:function(sliderEl,slideEl){var slideshow=this;slideshowLeftButton.classList.toggle(reversedClass,slideshow.page===0);slideshowRightButton.classList.toggle(reversedClass,slideshow.page+1===slideshow.pagesCount);if(paginationEl){paginationEl.innerText=slideshow.page+1+"/"+slideshow.pagesCount}captionText=slideEl.getAttribute("data-caption")||"";if(captionEl){captionEl.innerText=captionText}if(slideshowNavButtons){slideshowNavButtons=Array.from(slideshowNavButtons);slideshowNavButtons.forEach(function(buttonEl){buttonEl.classList.remove(activeClass)});if(slideshowNavButtons[slideshow.page]){slideshowNavButtons[slideshow.page].classList.add(activeClass)}}}})}var paginationEl=slideshowEl.querySelector(paginationSelector);if(paginationEl){paginationEl.innerText="1/"+slideshows[slideshowId].slides}var captionEl=slideshowEl.querySelector(captionSelector);if(captionEl){captionEl.innerText=slideshows[slideshowId].sliderEl.querySelector(itemSelector).getAttribute("data-caption")||""}}Waypoint.refreshAll()}});window.addEventListener("resize",function(){viewportHeight=Math.max(doc.documentElement.clientHeight,window.innerHeight||0)})},scrollButtons:function(){var scrollButtons=doc.querySelectorAll(".js-scrollButton");var moveTo=new MoveTo({duration:800});Array.from(scrollButtons,function(buttonEl){buttonEl.addEventListener("click",function(e){var targetEl=doc.getElementById(buttonEl.getAttribute("data-target"));if(targetEl){moveTo.move(targetEl)}e.preventDefault()})})},chapters:function(){var chapterSections=doc.querySelectorAll(".js-chapterSection");var paginationEl=doc.querySelector(".js-chapterPagination");var defaultTitle=paginationEl.getAttribute("data-default");Array.from(chapterSections,function(sectionEl){return new Waypoint({element:sectionEl,handler:function(direction){var paginationTitle=defaultTitle;if(direction==="down"){paginationTitle=this.element.getAttribute("data-pagination")}else{var previousWaypoint=this.previous();if(previousWaypoint){paginationTitle=previousWaypoint.element.getAttribute("data-pagination")}}paginationEl.innerText=paginationTitle}})})}};window.addEventListener("load",Ninnan.init,false)})(window);